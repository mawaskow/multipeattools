{% extends "base.html" %}

{% block title %}Policy Page{% endblock %}

{% block content %}
<div class="container" style="min-height: 760px;">
    <!-- this policy-store passes the information from the python flask app to the html for storage, so javascript can access it-->
    <div id="pol_id-store" style="display:none">{{pol_id}}</div>
    <div id="policy_div"></div>
</div>

<script>
    var pol_id = parseInt(document.getElementById("pol_id-store").innerHTML);
    //console.log(pol_id);

    // defining dictionaries: the formatting of these pills can be found in style.css
    const pillDct = 
        {'Economy': `econ-class-pill`,
        'Land-Use / Agriculture': `land-class-pill`,
        'Environmental quality: water, soil, air':`env-class-pill`,
        'Community and Culture':`comm-class-pill`,
        'Climate':`clm-class-pill`,
        'Energy':`enr-class-pill`,
        'Biodiversity':`bio-class-pill`,
        'Research and applied sciences':`res-class-pill`,
        //
        'Land Use / Agriculture': `land-class-pill`,
        'Climate Action':`clm-class-pill`,
        'Research and Applied Sciences':`res-class-pill`,
        'Environment Quality':`env-class-pill`,
        };
    // this just normalizes the names being used to display in the category pills
    const pillNames = 
        {'Economy': `Economy`,
        'Land-Use / Agriculture': `Land-Use / Agriculture`,
        'Environmental quality: water, soil, air':`Environmental Quality`,
        'Community and Culture':`Community and Culture`,
        'Climate':`Climate`,
        'Energy':`Energy`,
        'Biodiversity':`Biodiversity`,
        'Research and applied sciences':`Research`,
        //
        'Land Use / Agriculture': `Land-Use / Agriculture`,
        'Climate Action':`Climate`,
        'Research and Applied Sciences':`Research`,
        'Environment Quality':`Environmental Quality`,
        };
    // adds countries for flags/levels
    //https://www.alt-codes.net/flags
    const flagmojis = {
        "Global":"🌐",
        "European":"🇪🇺",
        "Austria":"🇦🇹",
        "Belgium":"🇧🇪",
        "Bulgaria":"🇧🇬",
        "Croatia":"🇭🇷",
        "Cyprus":"🇨🇾",
        "Czech Republic":"🇨🇿",
        "Denmark":"🇩🇰",
        "Estonia":"🇪🇪",
        "Finland":"🇫🇮",
        "France":"🇫🇷",
        "Germany":"🇩🇪",
        "Greece":"🇬🇷",
        "Hungary":"🇭🇺",
        "Iceland":"🇮🇸",
        "Ireland":"🇮🇪",
        "Italy":"🇮🇹",
        "Latvia":"🇱🇻",
        "Liechtenstein":"🇱🇮",
        "Lithuania":"🇱🇹",
        "Luxembourg":"🇱🇺",
        "Malta":"🇲🇹",
        "Netherlands":"🇳🇱",
        "Norway":"🇳🇴",
        "Poland":"🇵🇱",
        "Portugal":"🇵🇹",
        "Romania":"🇷🇴",
        "Slovakia":"🇸🇰",
        "Slovenia":"🇸🇮",
        "Spain":"🇪🇸",
        "Sweden":"🇸🇪",
        "Switzerland":"🇨🇭",
        "United Kingdom":"🇬🇧"
    }
    // traductions for the word "Overview" in different languages
    const transl_overview = {
        "Flemish":"Overzicht",
        "French":"Aperçu",
        "English":"Overview",
        "Bulgarian":"Общ преглед",
        "Croatian":"Pregled",
        "Turkish":"genel bakış",
        "Czech":"Přehled",
        "Danish":"Oversigt",
        "Estonian":"Ülevaade",
        "Finnish":"Yleiskatsaus",
        "German":"Überblick",
        "Greek":"Επισκόπηση",
        "Hungarian":"Áttekintés",
        "Icelandic":"Yfirlit",
        "Irish":"Overview",
        "Italian":"Panoramica",
        "Latvian":"Pārskats",
        "Lithuanian":"Apžvalga",
        "Maltese":"ħarsa ġenerali",
        "Dutch":"Overzicht",
        "Norwegian":"Oversikt",
        "Polish":"Przegląd",
        "Portuguese":"Visão geral",
        "Romanian":"Prezentare generală",
        "Slovak":"Prehľad",
        "Slovenian":"Pregled",
        "Spanish":"Resumen",
        "Swedish":"Översikt",
    }

    // traductions for the word "Table of Contents" in different languages
    const transl_toc = {
        "Flemish": "Inhoudsopgave", 
        "French": "Table des matières",
        "English": "Table of Contents",
        "Bulgarian": "Съдържание",
        "Croatian": "Sadržaj",
        "Turkish": "İçindekiler",
        "Czech": "Obsah",
        "Danish": "Indholdsfortegnelse",
        "Estonian": "Sisukord",
        "Finnish": "Sisällysluettelo",
        "German": "Inhaltsverzeichnis",
        "Greek": "Πίνακας περιεχομένων",
        "Hungarian": "Tartalomjegyzék",
        "Icelandic": "Efnisyfirlit",
        "Irish": "Clár Ábhair", 
        "Italian": "Indice",
        "Latvian": "Saturs",
        "Lithuanian": "Turinys",
        "Maltese": "Wer", 
        "Dutch": "Inhoudsopgave",
        "Norwegian": "Innholdsfortegnelse",
        "Polish": "Spis treści",
        "Portuguese": "Índice",
        "Romanian": "Cuprins",
        "Slovak": "Obsah",
        "Slovenian": "Kazalo",
        "Spanish": "Índice",
        "Swedish": "Innehållsförteckning",
        // Ajoutez d'autres langues si nécessaire
    };

        // traductions for country names in their native languages
    const transl_countries = {
        "Austria":{
            "German":"Österreich",
            "English":"Austria",
        },
        "Belgium":{
            "French": "Belgique", 
            "Dutch": "België",
            "English": "Belgium",
            "German": "Belgien",
            "Flemish": "België",
        },
        "Bulgaria":{
            "Bulgarian": "България",
            "English": "Bulgaria",
        },
        "Croatia":{
            "Croatian": "Hrvatska",
            "English": "Croatia",
        },
        "Cyprus":{
            "Greek": "Κύπρος",
            "Turkish": "Kıbrıs",
            "English": "Cyprus",
        },
        "Czech Republic":{
            "Czech": "Česká republika",
            "English": "Czech Republic",
        },
        "Denmark": {
            "Danish":"Danmark",
            "English":"Denmark",
        },
        "Estonia": {
            "Estonian":"Eesti",
            "English":"Estonia",
        },
        "Finland": {
            "Finnish":"Suomi",
            "Swedish":"Finland",
            "English":"Finland",
        },
        "France": {
            "French":"France",
            "English":"France",
        },
        "Germany": {
            "German":"Deutschland",
            "English":"Germany",
        },
        "Greece": {
            "Greek":"Ελλάδα",
            "English":"Greece",
        },
        "Hungary": {
            "Hungarian":"Magyarország",
            "English":"Hungary",
        },
        "Iceland": {
            "Icelandic":"Ísland",
            "English":"Iceland",
        },
        "Ireland": {
            "Irish":"Éire",
            "English":"Ireland",
        },
        "Italy": {
            "Italian":"Italia",
            "English":"Italy",
        },
        "Latvia": {
            "Latvian":"Latvija",
            "English":"Latvia",
        },
        "Liechtenstein": {
            "German":"Liechtenstein",
            "English":"Liechtenstein",
        },
        "Lithuania": {
            "Lithuanian":"Lietuva",
            "English":"Lithuania",
        },
        "Luxembourg": {
            "Luxembourgish":"Lëtzebuerg",
            "French":"Luxembourg",
            "German":"Luxemburg",
            "English":"Luxembourg",
        },
        "Malta": {
            "Maltese":"Malta",
            "English":"Malta",
        },
        "Netherlands": {
            "Dutch":"Nederland",
            "English":"Netherlands",
        },
        "Norway": {
            "Norwegian":"Norge",
            "English":"Norway",
        },
        "Poland": {
            "Polish":"Polska",
            "English":"Poland",
        },
        "Portugal": {
            "Portuguese":"Portugal",
            "English":"Portugal",
        },
        "Romania": {
            "Romanian":"România",
            "English":"Romania",
        },
        "Slovakia": {
            "Slovak":"Slovensko",
            "English":"Slovakia",
        },
        "Slovenia": {
            "Slovenian":"Slovenija",
            "English":"Slovenia",
        },
        "Spain": {
            "Spanish":"España",
            "English":"Spain",
        },
        "Sweden": {
            "Swedish":"Sverige",
            "English":"Sweden",
        },
        "Switzerland": {
            "German":"Schweiz",
            "French":"Suisse",
            "Italian":"Svizzera",
            "Romansh":"Svizra",
            "English":"Switzerland",
        },
        "United Kingdom": {
            "English":"United Kingdom",
        },
    };

    // traductions for "Policy Document" in different languages
    const transl_policy_document = {
        "Flemish": "Beleidsdocument",
        "English": "Policy Document",
        "German": "Politikdokument", 
        "French": "Document de la politique", 
        "Bulgarian": "Политически документ",
        "Croatian": "Dokument politike",
        "Turkish": "Politika Belgesi", 
        "Czech": "Politický dokument",
        "Danish": "Politikdokument",
        "Estonian": "Poliitikadokument",
        "Finnish": "Toimintalinjadokumentti",
        "Greek": "Έγγραφο πολιτικής",
        "Hungarian": "Politikai dokumentum",
        "Icelandic": "Stefnumálaskjal",
        "Irish": "Cáipéis Beartais", 
        "Italian": "Documento di politica",
        "Latvian": "Politikas dokuments",
        "Lithuanian": "Politikos dokumentas",
        "Maltese": "Dokument tal-Politika",
        "Dutch": "Beleidsdocument", 
        "Norwegian": "Policy Dokument",
        "Polish": "Dokument polityczny",
        "Portuguese": "Documento de política",
        "Romanian": "Document de politică",
        "Slovak": "Politický dokument",
        "Slovenian": "Dokument politike",
        "Spanish": "Documento de política",
        "Swedish": "Policydokument",
    };

    // traductions for "Policy Info Page" in different languages
    const transl_policy_info_page = {
        "Flemish": "Beleidsinfopagina",        
        "English": "Policy Info Page",
        "German": "Politikinformationsseite",
        "French": "Page d'information sur la politique",
        "Bulgarian": "Информационна страница за политиката",
        "Croatian": "Stranica s informacijama o politici",
        "Turkish": "Politika Bilgi Sayfası",
        "Czech": "Informační stránka o politice",
        "Danish": "Informationsside om politik",
        "Estonian": "Poliitika infoleht",
        "Finnish": "Toimintalinjan infosivu",
        "Greek": "Σελίδα πληροφοριών πολιτικής",
        "Hungarian": "Politikai információs oldal",
        "Icelandic": "Upplýsingasíða stefnu",
        "Irish": "Leathanach Eolais Beartais", 
        "Italian": "Pagina info politica",
        "Latvian": "Politikas informācijas lapa",
        "Lithuanian": "Politikos informacijos puslapis",
        "Maltese": "Paġna ta' Informazzjoni dwar il-Politika",
        "Dutch": "Beleidsinfopagina",
        "Norwegian": "Informasjonsside for policy",
        "Polish": "Strona informacyjna polityki",
        "Portuguese": "Página de informação da política",
        "Romanian": "Pagină de informații despre politică",
        "Slovak": "Informačná stránka politiky",
        "Slovenian": "Stran s podatki o politiki",
        "Spanish": "Página de información de la política",
        "Swedish": "Policysida",
    };

    //translation for the different scales in different languages
    const transl_scale = {
        "Flemish":{
            "Global":"Globaal",
            "European":"Europees",
            "National":"Nationaal",
            "Regional":"Regionaal",
            "Local":"Lokaal"
        },
        "English":{
            "Global":"Global",
            "European":"European",
            "National":"National",
            "Regional":"Regional",
            "Local":"Local"
        },
        "German":{
            "Global":"Global",
            "European":"Europäisch",
            "National":"National",
            "Regional":"Regional",
            "Local":"Lokal"
        },
        "French":{
            "Global":"Mondial",
            "European":"Européen",
            "National":"National",
            "Regional":"Régional",
            "Local":"Local"
        },
        "Bulgarian":{
            "Global":"Глобален",
            "European":"Европейски",
            "National":"Национален",
            "Regional":"Регионален",
            "Local":"Местен"
        },
        "Croatian":{
            "Global":"Globalni",
            "European":"Europski",
            "National":"Nacionalni",
            "Regional":"Regionalni",
            "Local":"Lokalni"
        },
        "Turkish":{
            "Global":"Küresel",
            "European":"Avrupa",
            "National":"Ulusal",
            "Regional":"Bölgesel",
            "Local":"Yerel"
        },
        "Czech":{
            "Global":"Globální",
            "European":"Evropský",
            "National":"Národní",
            "Regional":"Regionální",
            "Local":"Místní"
        },
        "Danish":{
            "Global":"Global",
            "European":"Europæisk",
            "National":"National",
            "Regional":"Regional",
            "Local":"Lokal"
        },
        "Estonian":{
            "Global":"Globaalne",
            "European":"Euroopalik",
            "National":"Rahvuslik",
            "Regional":"Piirkondlik",
            "Local":"Kohalik"
        },
        "Finnish":{
            "Global":"Maailmanlaajuisesti",
            "European":"Eurooppalainen",
            "National":"Kansallinen",
            "Regional":"Alueellinen",
            "Local":"Paikallinen"
        },
        "Greek":{
            "Global":"Παγκόσμιος",
            "European":"Ευρωπαϊκός",
            "National":"Εθνικός",
            "Regional":"Περιφερειακός",
            "Local":"Τοπικός"
        },
        "Hungarian":{
            "Global":"Globális",
            "European":"Európai",
            "National":"Nemzeti",
            "Regional":"Regionális",
            "Local":"Helyi"
        },
        "Icelandic":{
            "Global":"Heims",
            "European":"Evrópskur",
            "National":"Þjóðlegur",
            "Regional":"Svæðisbundinn",
            "Local":"Staðbundinn"
        },
        "Irish":{
            "Global":"Domhanda",
            "European":"Eorpach",
            "National":"Náisiúnta",
            "Regional":"Réigiúnach",
            "Local":"Áitiúil"
        },
        "Italian":{
            "Global":"Globale",
            "European":"Europeo",
            "National":"Nazionale",
            "Regional":"Regionale",
            "Local":"Locale"
        },
        "Latvian":{
            "Global":"Globāli",
            "European":"Eiropiešu",
            "National":"Nacionāls",
            "Regional":"reģionālā",
            "Local":"Vietējā"
        },
        "Lithuanian":{
            "Global":"Globalus",
            "European":"Eeuropietiškas",
            "National":"Nacionalinis",
            "Regional":"Regioninis",
            "Local":"Vietinis"
        },
        "Maltese":{
            "Global":"Globali",
            "European":"Ewropew",
            "National":"Nazzjonali",
            "Regional":"Reġjonali",
            "Local":"Lokali"
        },
        "Dutch":{
            "Global":"Wereldwijd",
            "European":"Europese",
            "National":"Nationaal",
            "Regional":"Regionaal",
            "Local":"Lokaal"
        },
        "Norwegian":{
            "Global":"Global",
            "European":"Europeisk",
            "National":"Nasjonal",
            "Regional":"Regional",
            "Local":"Lokale"
        },
        "Polish":{
            "Global":"Światowy",
            "European":"Europejski",
            "National":"Krajowy",
            "Regional":"Regionalny",
            "Local":"Lokalny"
        },
        "Portuguese":{
            "Global":"Global",
            "European":"Europeu",
            "National":"Nacional",
            "Regional":"Regional",
            "Local":"Local"
        },
        "Romanian":{
            "Global":"Globală",
            "European":"European",
            "National":"Național",
            "Regional":"Regional",
            "Local":"Local"
        },
        "Slovak":{
            "Global":"Globálne",
            "European":"Európsky",
            "National":"Národné",
            "Regional":"Regionálne",
            "Local":"Miestne"
        },
        "Slovenian":{
            "Global":"Globalno",
            "European":"Evropski",
            "National":"Nacionalni",
            "Regional":"Regionalni",
            "Local":"Lokalni"
        },
        "Spanish":{
            "Global":"Global",
            "European":"Europeo",
            "National":"Nacional",
            "Regional":"Regional",
            "Local":"Local"
        },
        "Swedish":{
            "Global":"Global",
            "European":"Europeisk",
            "National":"Nationell",
            "Regional":"Regional",
            "Local":"Lokal"
        },
    };

    // translation for categories in different languages
    const transl_categories = {
        "Flemish": {
            "Economy": "Economie",
            "Land-Use / Agriculture": "Grondgebruik / Landbouw",
            "Environmental Quality": "Milieu Kwaliteit",
            "Community and Culture": "Gemeenschap en Cultuur",
            "Climate": "Klimaat",
            "Energy": "Energie",
            "Biodiversity": "Biodiversiteit",
            "Research": "Onderzoek",
        },
        "English": {
            "Economy": "Economy",
            "Land-Use / Agriculture": "Land-Use / Agriculture",
            "Environmental Quality": "Environmental Quality",
            "Community and Culture": "Community and Culture",
            "Climate": "Climate",
            "Energy": "Energy",
            "Biodiversity": "Biodiversity",
            "Research": "Research",
        },
        "German": {
            "Economy": "Wirtschaft",
            "Land-Use / Agriculture": "Landnutzung / Landwirtschaft",
            "Environmental Quality": "Umweltqualität",
            "Community and Culture": "Gemeinschaft und Kultur",
            "Climate": "Klima",
            "Energy": "Energie",
            "Biodiversity": "Biodiversität",
            "Research": "Forschung",
        },
        "French": {
            "Economy": "Économie",
            "Land-Use / Agriculture": "Utilisation des terres / Agriculture",
            "Environmental Quality": "Qualité environnementale",
            "Community and Culture": "Communauté et culture",
            "Climate": "Climat",
            "Energy": "Énergie",
            "Biodiversity": "Biodiversité",
            "Research": "Recherche",
        },
        "Bulgarian": {
            "Economy": "Икономика",
            "Land-Use / Agriculture": "Използване на земята / Земеделие",
            "Environmental Quality": "Качество на околната среда",
            "Community and Culture": "Общност и култура",
            "Climate": "Климат",
            "Energy": "Енергия",
            "Biodiversity": "Биоразнообразие",
            "Research": "Изследвания",
        },
        "Croatian": {
            "Economy": "Ekonomija",
            "Land-Use / Agriculture": "Korištenje zemljišta / Poljoprivreda",
            "Environmental Quality": "Kvaliteta okoliša",
            "Community and Culture": "Zajednica i kultura",
            "Climate": "Klima",
            "Energy": "Energija",
            "Biodiversity": "Bioraznolikost",
            "Research": "Istraživanje",
        },
        "Turkish": {
            "Economy": "Ekonomi",
            "Land-Use / Agriculture": "Arazi Kullanımı / Tarım",
            "Environmental Quality": "Çevresel Kalite",
            "Community and Culture": "Toplum ve Kültür",
            "Climate": "İklim",
            "Energy": "Enerji",
            "Biodiversity": "Biyoçeşitlilik",
            "Research": "Araştırma",
        },
        "Czech": {
            "Economy": "Ekonomika",
            "Land-Use / Agriculture": "Využití půdy / Zemědělství",
            "Environmental Quality": "Kvalita životního prostředí",
            "Community and Culture": "Komunita a kultura",
            "Climate": "Klima",
            "Energy": "Energie",
            "Biodiversity": "Biodiverzita",
            "Research": "Výzkum",
        },
        "Danish": {
            "Economy": "Økonomi",
            "Land-Use / Agriculture": "Arealanvendelse / Landbrug",
            "Environmental Quality": "Miljøkvalitet",
            "Community and Culture": "Fællesskab og kultur",
            "Climate": "Klima",
            "Energy": "Energi",
            "Biodiversity": "Biodiversitet",
            "Research": "Forskning",
        },
        "Estonian": {
            "Economy": "Majandus",
            "Land-Use / Agriculture": "Maa kasutamine / Põllumajandus",
            "Environmental Quality": "Keskkonna kvaliteet",
            "Community and Culture": "Kogukond ja kultuur",
            "Climate": "Kliima",
            "Energy": "Energia",
            "Biodiversity": "Biodiversiteet",
            "Research": "Uuringud",
        },
        "Finnish": {
            "Economy": "Talous",
            "Land-Use / Agriculture": "Maan käyttö / Maatalous",
            "Environmental Quality": "Ympäristön laatu",
            "Community and Culture": "Yhteisö ja kulttuuri",
            "Climate": "Ilmasto",
            "Energy": "Energia",
            "Biodiversity": "Biodiversiteetti",
            "Research": "Tutkimus",
        },
        "Greek": {
            "Economy": "Οικονομία",
            "Land-Use / Agriculture": "Χρήση γης / Γεωργία",
            "Environmental Quality": "Ποιότητα περιβάλλοντος",
            "Community and Culture": "Κοινότητα και Πολιτισμός",
            "Climate": "Κλίμα",
            "Energy": "Ενέργεια",
            "Biodiversity": "Βιοποικιλότητα",
            "Research": "Έρευνα",
        },
        "Hungarian": {
            "Economy": "Gazdaság",
            "Land-Use / Agriculture": "Földhasználat / Mezőgazdaság",
            "Environmental Quality": "Környezeti minőség",
            "Community and Culture": "Közösség és kultúra",
            "Climate": "Éghajlat",
            "Energy": "Energia",
            "Biodiversity": "Biodiverzitás",
            "Research": "Kutatás",
        },
        "Icelandic": {
            "Economy": "Efnahagur",
            "Land-Use / Agriculture": "Landnotkun / Landbúnaður",
            "Environmental Quality": "Umhverfiskvalitet",
            "Community and Culture": "Samfélag og menning",
            "Climate": "Loftslag",
            "Energy": "Orka",
            "Biodiversity": "Líffræðileg fjölbreytni",
            "Research": "Rannsóknir",
        },
        "Irish": {
            "Economy": "Geilleagar",
            "Land-Use / Agriculture": "Úsáid Talamh / Talmhaíocht",
            "Environmental Quality": "Cáilíocht Comhshaoil",
            "Community and Culture": "Pobal agus Cultúr",
            "Climate": "Aeráid",
            "Energy": "Fuinneamh",
            "Biodiversity": "Biodiversité",
            "Research": "Taighde",
        },
        "Italian": {
            "Economy": "Economia",
            "Land-Use / Agriculture": "Uso del suolo / Agricoltura",
            "Environmental Quality": "Qualità ambientale",
            "Community and Culture": "Comunità e cultura",
            "Climate": "Clima",
            "Energy": "Energia",
            "Biodiversity": "Biodiversità",
            "Research": "Ricerca",
        },
        "Latvian": {
            "Economy": "Ekonomika",
            "Land-Use / Agriculture": "Zemes izmantošana / Lauksaimniecība",
            "Environmental Quality": "Vides kvalitāte",
            "Community and Culture": "Kopiena un kultūra",
            "Climate": "Klimats",
            "Energy": "Enerģija",
            "Biodiversity": "Bioloģiskā daudzveidība",
            "Research": "Pētniecība",
        },
        "Lithuanian": {
            "Economy": "Ekonomika",
            "Land-Use / Agriculture": "Žemės naudojimas / Žemės ūkis",
            "Environmental Quality": "Aplinkos kokybė",
            "Community and Culture": "Bendruomenė ir kultūra",
            "Climate": "Klimatas",
            "Energy": "Energija",
            "Biodiversity": "Biologinė įvairovė",
            "Research": "Tyrimai",
        },
        "Maltese": {
            "Economy": "Ekonomija",
            "Land-Use / Agriculture": "Użu tal-Art / Agrikoltura",
            "Environmental Quality": "Kwalità Ambjentali",
            "Community and Culture": "Komunità u Kultura",
            "Climate": "Klima",
            "Energy": "Enerġija",
            "Biodiversity": "Biodiversità",
            "Research": "Riċerka",
        },
        "Dutch": {
            "Economy": "Economie",
            "Land-Use / Agriculture": "Grondgebruik / Landbouw",
            "Environmental Quality": "Milieu kwaliteit",
            "Community and Culture": "Gemeenschap en Cultuur",
            "Climate": "Klimaat",
            "Energy": "Energie",
            "Biodiversity": "Biodiversiteit",
            "Research": "Onderzoek",
        },
        "Norwegian": {
            "Economy": "Økonomi",
            "Land-Use / Agriculture": "Landområdebruk / Landbruk",
            "Environmental Quality": "Miljøkvalitet",
            "Community and Culture": "Samfunn og kultur",
            "Climate": "Klima",
            "Energy": "Energi",
            "Biodiversity": "Biodiversitet",
            "Research": "Forskning",
        },
        "Polish": {
            "Economy": "Gospodarka",
            "Land-Use / Agriculture": "Użytkowanie ziemi / Rolnictwo",
            "Environmental Quality": "Jakość środowiska",
            "Community and Culture": "Społeczność i kultura",
            "Climate": "Klimat",
            "Energy": "Energia",
            "Biodiversity": "Bioróżnorodność",
            "Research": "Badania",
        },
        "Portuguese": {
            "Economy": "Economia",
            "Land-Use / Agriculture": "Uso da Terra / Agricultura",
            "Environmental Quality": "Qualidade Ambiental",
            "Community and Culture": "Comunidade e Cultura",
            "Climate": "Clima",
            "Energy": "Energia",
            "Biodiversity": "Biodiversidade",
            "Research": "Pesquisa",
        },
        "Romanian": {
            "Economy": "Economia",
            "Land-Use / Agriculture": "Utilizarea terenurilor / Agricultură",
            "Environmental Quality": "Calitatea mediului",
            "Community and Culture": "Comunitate și cultură",
            "Climate": "Climă",
            "Energy": "Energie",
            "Biodiversity": "Biodiversitate",
            "Research": "Cercetare",
        },
        "Slovak": {
            "Economy": "Hospodárstvo",
            "Land-Use / Agriculture": "Využitie pôdy / Poľnohospodárstvo",
            "Environmental Quality": "Kvalita životného prostredia",
            "Community and Culture": "Komunita a kultúra",
            "Climate": "Klíma",
            "Energy": "Energia",
            "Biodiversity": "Biodiverzita",
            "Research": "Výskum",
        },
        "Slovenian": {
            "Economy": "Gospodarstvo",
            "Land-Use / Agriculture": "Raba zemljišč / Kmetijstvo",
            "Environmental Quality": "Kakovost okolja",
            "Community and Culture": "Skupnost in kultura",
            "Climate": "Podnebje",
            "Energy": "Energija",
            "Biodiversity": "Biotska raznovrstnost",
            "Research": "Raziskave",
        },
        "Spanish": {
            "Economy": "Economía",
            "Land-Use / Agriculture": "Uso de la tierra / Agricultura",
            "Environmental Quality": "Calidad ambiental",
            "Community and Culture": "Comunidad y cultura",
            "Climate": "Clima",
            "Energy": "Energía",
            "Biodiversity": "Biodiversidad",
            "Research": "Investigación",
        },
        "Swedish": {
            "Economy": "Ekonomi",
            "Land-Use / Agriculture": "Markanvändning / Jordbruk",
            "Environmental Quality": "Miljö kvalitet",
            "Community and Culture": "Gemenskap och kultur",
            "Climate": "Klimat",
            "Energy": "Energi",
            "Biodiversity": "Biodiversitet",
            "Research": "Forskning",
        },
    };

    const policy_category_mappings= {
        "Biodiversity":{
            "green":["Circular Economy"],
            "sdg":["Life Land", "Life Water"]
        },
        "Climate":{
            "green":["Climate", "Zero Pollution"],
            "sdg":["Climate Action"]
        },
        "Climate Action":{
            "green":["Climate", "Zero Pollution"],
            "sdg":["Climate Action"]
        },
        "Community and Culture":{
            "green":["Circular Economy", "Natural Capital", "Just Transition", "Transformation"],
            "sdg":["Economic Growth", "Communities"]
        },
        "Economy":{
            "green":["Financing the Transition", "Circular Economy"],
            "sdg":["Economic Growth", "Consumption"]
        },
        "Energy":{
            "green":["Clean Energy", "Zero Pollution"],
            "sdg":["Clean Energy"]
        },
        "Environmental Quality":{
            "green":["Natural Capital", "Zero Pollution"],
            "sdg":["Life Water", "Clean Water"]
        },
        "Environment Quality":{
            "green":["Natural Capital", "Zero Pollution"],
            "sdg":["Life Water", "Clean Water"]
        },
        "Land-Use / Agriculture":{
            "green":["CAP", "Transformation", "Farm to Fork"],
            "sdg":["Life Land"]
        },
        "Land Use / Agriculture":{
            "green":["CAP", "Transformation", "Farm to Fork"],
            "sdg":["Life Land"]
        },
        "Research":{
            "green":["Circular Economy"],
            "sdg":["Consumption"]
        },
        "Research and Applied Sciences":{
            "green":["Circular Economy"],
            "sdg":["Consumption"]
        }
    };
    //https://www.compostnetwork.info/eu-green-deal/
    const greendeal_categories ={
        "Circular Economy":"Transition to a Circular Economy",
        "Zero Pollution":"A Zero Pollution Europe",
        "Farm to Fork":"Farm to Fork",
        "Transformation":"The Transformation of Agriculture and Rural Areas",
        "CAP":"Towards a Modernised and Simplified CAP",
        "Just Transition":"Leave No One Behind (Just Transition)",
        "Financing the Transition":"Financing the Transition",
        "Clean Energy":"Clean, Reliable, and Affordable Energy",
        "Climate":"Achieving Climate Neutrality",
        "Transport":"Sustainable Transport",
        "Natural Capital":"Preserving Europe's Natural Capital"
    };
    //https://sdgs.un.org/goals
    const sdg_categories={
        "Climate Action":"13 Climate Action",
        "Life Water":"14 Life below Water",
        "Consumption":"12 Responsible Consumption & Production",
        "Life Land":"15 Life on Land",
        "Clean Water":"6 Clean Water & Sanitation",
        "Clean Energy":"7 Affordable & Clean Energy",
        "Economic Growth":"8 Decent Work & Economic Growth",
        "Infrastructure":"9 Industry, Innovation & Infrastructure",
        "Communities":"11 Sustainable Cities & Communities"
    };

    // how to display policies
    function policyShow(policy, currentLang = 'English'){
        console.log(policy);
        const polPop = $('#policy_div');
        polPop.html('');

        // get the language of the policy
        var lang=policy['language'].split(" ");
        var lang_pol=lang[0];

        var pol_title_english = policy["name"];
        var pol_title_native = policy["name_language"];
        let pol_title_to_display = (currentLang === 'English') ? pol_title_english : pol_title_native;

        // categories html, gets all categories in their pill form
        var primary_category_english= pillNames[policy["primary_category"]];
        var primary_category_native=transl_categories[lang_pol][pillNames[policy["primary_category"]]];
        let primary_category_to_display = (currentLang === 'English') ? primary_category_english : primary_category_native;

        var categ_coll = [`<p class="badge rounded-pill ${ pillDct[policy["primary_category" ]] }" style="font-size:17px; font-weight:400;margin-bottom:5px;">${ primary_category_to_display}</p>`];
        var categ_lst = policy["category"].sort();
        if(categ_lst.length > 1){
            categ_coll.push(`|`);
        }
        for (let c=0; c < categ_lst.length; c++){
            if(categ_lst[c] != policy["primary_category"]){
                var category_native = transl_categories[lang_pol][pillNames[categ_lst[c]]];
                var category_english = pillNames[categ_lst[c]];
                let category_to_display = (currentLang === 'English') ? categ_lst[c] : category_native;
                categ_coll.push(`<p class="badge rounded-pill ${ pillDct[categ_lst[c]] }" style="font-size:17px; font-weight:400;margin-bottom:5px;">${ category_to_display }</p>`);
            }
        }
        var categs_html = categ_coll.join(" ");
        var green_goals =[];
        var sdgs = [];
        categ_lst.forEach(categ => {
            //green_goals.concat(policy_category_mappings[categ]["green"]);
            //sdgs.concat(policy_category_mappings[categ]["sdg"])
            var gr = policy_category_mappings[categ]["green"];
            var sd = policy_category_mappings[categ]["sdg"];
            gr.forEach(gr =>{
                green_goals.push(gr);
            });
            sd.forEach(sd =>{
                sdgs.push(sd);
            });
        });
        let green_uniq = new Set(green_goals.sort());
        let sdg_uniq = new Set(sdgs.sort());
        
        var green_coll = [];
        var sdg_coll = [];
        green_uniq.forEach(goal => {
            green_coll.push(`<p class="badge rounded-pill text-bg-secondary" style="font-size:14px; font-weight:400;margin-bottom:5px;">${ greendeal_categories[goal] }</p>`);
        });
        sdg_uniq.forEach(goal => {
            sdg_coll.push(`<p class="badge rounded-pill text-bg-secondary" style="font-size:14px; font-weight:400;margin-bottom:5px;">${ sdg_categories[goal] }</p>`);
        });
        var green_html = green_coll.join(" ");
        var sdg_html = sdg_coll.join(" ");

        // publishers html
        var publs_coll = [];
        policy["publisher"].forEach(publisher =>
                publs_coll.push(`<p class="d-inline">${publisher}</p>`)
            );
        var publs = publs_coll.join(`<br><p class="d-inline" style="font-size:16px">👤</p><p class="d-inline">`);
        var publs_html = `<p class="d-inline publisher-icon" style="font-size:16px">👤</p>${publs}`;
        
        let truncatedPublishers = '';
        let fullPublishers = '';
        const allPublishers = policy['publisher'];

        truncatedPublishers = `<span><p class="d-inline publisher-icon" style="font-size:16px">👤</p><p class="d-inline">${allPublishers[0]}</p></span>`;
        fullPublishers=publs_html
        var publisher_section_html =`
            <span class="publisher-list-container">
                <span class="publisher-text truncated-version">${truncatedPublishers}</span>
                ${ allPublishers.length > 1 ? `<span class="ellipsis-placeholder">...</span>` : '' }
                <span class="publisher-text full-version hidden">
                    ${fullPublishers}
                </span>
                <button class="publisher-more-less-button hidden"></button>
            </span>
        `;

        // level / sublevel html, accounts for global and european, adds emojis
        var lvl_area_html = ``;

        var name_country_english= policy['country'];
        var name_country_native= '';
        let name_country_to_display = ''
        if(name_country_english){
            name_country_native= transl_countries[policy['country']][lang_pol];
            name_country_to_display = (currentLang === 'English') ? name_country_english : name_country_native;
        }
        var lvl_area_english= policy['policy_level'];
        var lvl_area_native= transl_scale[lang_pol][policy['policy_level']];
        let lvl_area_display = (currentLang === 'English') ? lvl_area_english : lvl_area_native;

        if(["European", "Global"].includes(policy['policy_level'])){
            lvl_area_html = `<p class="d-inline" style="font-size:20px">${ flagmojis[lvl_area_display] }</p> <p class="d-inline">${ lvl_area_display } </p>`;
        }else{
            if(policy["country"] in flagmojis){
                lvl_area_html = `<p class="d-inline" style="font-size:20px">${ flagmojis[name_country_english] }</p> <p class="d-inline" style="font-size:20px">${name_country_to_display} | ${ lvl_area_display } </p>`;
            }else{
                lvl_area_html = `<p style="font-size:20px"> ${ name_country_to_display } | ${ lvl_area_display } </p>`;
            }
        }

        // duration html, accounts for missing dates
        var duratn_html = ``;
        if(policy['year_from'] && policy['year_to']){
            duratn_html = `${policy['year_from']}-${policy['year_to']}`;
        }else{
            if(policy['year_from']){
                duratn_html = `${policy['year_from']}-`;
            }else if(policy['year_to']){
                duratn_html = `-${policy['year_to']}`;
            }
        }

        // excerpt html
        if (policy['excerpt_english']) {var excerpt_html_english = `<p class="excerpt-text" align="justify"> ${policy['excerpt_english']}</p>`;}
        if (policy['excerpt']) {var excerpt_html_native = `<p class="excerpt-text" align="justify"> ${policy['excerpt']}</p>`;}

        let excerpt_html_to_display = (currentLang === 'English') ? excerpt_html_english : excerpt_html_native;

        // try to split abstract by \n to retain line breaks?
        if (policy['abstract_english']) {
            var abst_sents_english = policy['abstract_english'].split("\n");
            var abst_ps_english = [];
            abst_sents_english.forEach(sentence =>
                abst_ps_english.push(`<p class="poltxt">${ sentence }</p>`)
            );
            var abst_html_english = abst_ps_english.join(`<p style="margin-bottom:10px;"></p>`);
            var abst_html_section_english = `<div>
                                        <h3 class="section-title-container"><div class="section-title-box">Overview</div></h3>
                                        <div style="margin-bottom:10px; font-size:16px" align="justify">
                                            ${ abst_html_english }
                                        </div>
                                    </div>`
        }
        if (policy['abstract']) {
            var abst_sents_native = policy['abstract'].split("\n");
            var abst_ps_native = [];
            abst_sents_native.forEach(sentence =>
                abst_ps_native.push(`<p class="poltxt">${ sentence }</p>`)
            );
            var abst_html_native = abst_ps_native.join(`<p style="margin-bottom:10px;"></p>`);
            var abst_html_section_native = `<div>
                                        <h3 class="section-title-container"><div class="section-title-box">${transl_overview[lang_pol]}</div></h3>
                                        <div style="margin-bottom:10px; font-size:16px" align="justify">
                                            ${ abst_html_native }
                                        </div>
                                    </div>`
        }

        let abst_html_section_to_display = (currentLang === 'English') ? abst_html_section_english : abst_html_section_native;

        // split table of contents by \n to retain line breaks
        var toc_html_english = ``;
        var toc_html_section_english = ``;
        if(policy['toc_english']){
            var toc_lines_english = policy['toc_english'].split("\n");
            var toc_ps_english = [];
            toc_lines_english.forEach(line =>
                toc_ps_english.push(`<p class="poltxt">${ line }</p>`)
            );
            toc_html_english = toc_ps_english.join(`<p style="margin-bottom:10px;"></p>`);
            toc_html_section_english = `<div>
                                    <h3 class="section-title-container"><div class="section-title-box">Table of Contents</div></h3>
                                    <div style="margin-bottom:20px">
                                        ${ toc_html_english }
                                    </div>
                                </div>`
        }

        var toc_html_native = ``;
        var toc_html_section_native = ``;
        if(policy['toc']){
            console.log(policy['toc']);
            var toc_lines_native = policy['toc'].split("\n");
            var toc_ps_native = [];
            toc_lines_native.forEach(line =>
                toc_ps_native.push(`<p class="poltxt">${ line }</p>`)
            );
            toc_html_native = toc_ps_native.join(`<p style="margin-bottom:10px;"></p>`);
            toc_html_section_native = `<div>
                                    <h3 class="section-title-container"><div class="section-title-box">${transl_toc[lang_pol]}</div></h3>
                                    <div style="margin-bottom:20px">
                                        ${ toc_html_native }
                                    </div>
                                </div>`
        }else{
            console.log("No TOC?");
        }

        let toc_html_section_to_display = (currentLang === 'English') ? toc_html_section_english : toc_html_section_native;
           
        // create button to switch between languages
        
        var button_native=`<button data-lang="native" class="btn btn-outline-dark hidden" style="font-size:14px" >${ flagmojis[policy['country']] } ${lang_pol}</button>`
        var button_english=`<button data-lang="english" class="btn btn-outline-dark hidden" style="font-size:14px" >${ flagmojis['United Kingdom'] } English</button>`
        
        // links
        var name_link_doc_english = 'Policy Document'
        var name_link_doc_native = transl_policy_document[lang_pol];
        let name_link_doc_to_display = (currentLang === 'English') ? name_link_doc_english : name_link_doc_native;

        var name_link_info_english = 'Official Site'
        var name_link_info_native = transl_policy_info_page[lang_pol];
        let name_link_info_to_display = (currentLang === 'English') ? name_link_info_english : name_link_info_native;

        var links_html = `<a href="${ policy['data_link'] }" class="polcol-lnk d-inline" target="_blank">
                        ${name_link_doc_to_display}
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
                        </svg>
                    </a> | 
                    <a href="${ policy['documentation_link'] }" class="polcol-lnk d-inline" target="_blank">${name_link_info_to_display} ↗</a>`;

        // element to append to the policy           
        var element = `
                    <div style="display: flex; justify-content: flex-end; align-items: flex-start;margin-top:5px;">  
                        <div id="lang-btns">
                            ${button_native}
                            ${button_english}
                        </div>       
                    </div>
                    <h1 id="pol-res-he" class="policy-name-header">${pol_title_to_display}</h1>
                    <div>
                        ${lvl_area_html}
                        <p class="d-inline" style="font-size:20px"> | ${duratn_html} | </p> 
                        ${links_html}
                    </div> 
                    <div style="margin-top:3px">
                        ${ publisher_section_html }
                    </div>
                    <div style="display: flex; align-items: flex-start; gap: 20px;">
                        <div style="flex: 1; padding-right: 20px; min-width: 300px">
                            <div id="abstract-content">  
                                ${abst_html_section_to_display}
                            </div>
                            <div id="toc-content">        
                                ${toc_html_section_to_display}
                            </div>
                            <div style="margin-top:30px;">
                                Policy Categories: ${categs_html}
                            </div>  
                            <div style="margin-top:20px;">
                                Green Deal Goals: ${green_html}
                            </div>  
                            <div style="margin-top:20px;">
                                Sustainable Development Goals: ${sdg_html}
                            </div>  
                        </div>
                
                        <div class="right-content">
                            <div class="pdf-viewer-container">
                                <iframe src="${policy['data_link']}" class="pdf-iframe" align="center"></iframe>
                            </div>
                        </div>
                    </div>
                    
                    `;

        polPop.append(element);
        if(!policy){
            polPop.append(`<p class="text-center" style="color:black;">Policy not found.</p>`);
        }

        //
        const publisherListContainer = polPop.find('.publisher-list-container')[0];
        if (publisherListContainer) { 
            const allPublishers = policy['publisher'] || [];

            if (allPublishers.length > 1) { 
                const truncatedPublishersElement = publisherListContainer.querySelector('.publisher-text.truncated-version');
                const fullPublishersElement = publisherListContainer.querySelector('.publisher-text.full-version');
                const ellipsisPlaceholder = publisherListContainer.querySelector('.ellipsis-placeholder');
                const moreLessButton = publisherListContainer.querySelector('.publisher-more-less-button');

                moreLessButton.classList.remove('hidden');
                moreLessButton.textContent = 'More'; 
                ellipsisPlaceholder.classList.remove('hidden');

                moreLessButton.addEventListener('click', () => {
                    if (truncatedPublishersElement.classList.contains('hidden')) {
                        truncatedPublishersElement.classList.remove('hidden');
                        fullPublishersElement.classList.add('hidden');
                        ellipsisPlaceholder.classList.remove('hidden'); 
                        moreLessButton.textContent = 'More';
                    } else {
                        truncatedPublishersElement.classList.add('hidden');
                        fullPublishersElement.classList.remove('hidden');
                        ellipsisPlaceholder.classList.add('hidden'); 
                        moreLessButton.textContent = 'Less';
                    }
                });
            }
        }

        // add event listeners to the buttons
        if (lang_pol !== "English") {
            const button_english = document.querySelector('#lang-btns button[data-lang="english"]');
            button_english.classList.remove('hidden');
            const button_native = document.querySelector('#lang-btns button[data-lang="native"]');
            button_native.classList.remove('hidden');
            document.querySelectorAll('#lang-btns button').forEach(button => {
            button.addEventListener('click', () => {
                const lang = button.getAttribute('data-lang');
                policyShow(policy, lang); 
            });
        });  
        }
    }

    async function datafxn(pol_id){
        const url = `/sgpolicy/${pol_id}`;
        var pol_obj = {};
        try {
            const response = await fetch(url);
            if (!response.ok) {
            throw new Error(`Response status: ${response.status}`);
            }
            const json = await response.json();
            //console.log(json);
            pol_obj= json["result"]["policy"];
        } catch (error) {
            console.error(error.message);
        }
        policyShow(pol_obj, 'English')
        //
        //$('#policyliststore').val(JSON.stringify(polLst));
        //
        return pol_obj;
    }
    //policyShow(policy_obj, 'English');
    datafxn(pol_id);
</script>

{% endblock %}